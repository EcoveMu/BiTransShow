# 即時語音翻譯字幕

多語言會議字幕助手，支援即時語音識別和翻譯。

## 🆕 最新更新 (v2.3.3) - 增強版網頁字幕

### 網頁字幕完整功能
- 🎯 **多面板界面**：即時字幕、會話記錄、翻譯結果三個專門面板
- 📝 **完整記錄系統**：持續記錄所有對話內容，像獨立視窗一樣
- 🌐 **分離式翻譯**：專門的翻譯面板，方便查看和管理翻譯結果
- 📚 **會話歷史**：自動保存所有對話記錄，支援匯出功能
- 🎮 **專業界面**：可拖拽、可最小化的專業級字幕界面
- ⚡ **即時更新**：講者持續講話時，各面板同步更新內容

### v2.3.2 - 恢復網頁聲音監聽
- 🎤 **網頁字幕模式**：恢復監聽當前網頁聲音功能（Teams會議、YouTube等）
- 🪟 **獨立視窗模式**：適合實體會議和完整功能操作
- 🔄 **雙軌並行**：兩種模式各司其職，滿足不同使用場景
- ⚙️ **統一設定**：兩種模式共享相同的設定系統，確保一致性
- 🎯 **清晰功能**：popup界面明確區分兩種使用模式

### 雙模式並行
- 🎤 **網頁字幕模式**：專門監聽當前網頁聲音（Teams會議、YouTube、線上課程等）
- 🪟 **獨立視窗模式**：適合實體會議、多功能操作和高級設定
- 🔄 **智能分工**：根據使用場景選擇最適合的模式
- ⚙️ **統一設定**：兩種模式共享相同的翻譯、語音識別設定
- 🎯 **功能清晰**：popup界面明確區分兩種使用模式的差異

### 核心功能
- ✨ **免費翻譯功能** - 無需API金鑰即可使用
- 🪟 **獨立字幕視窗** - 可在實體會議中使用
- ⌨️ **全域快捷鍵** - `Ctrl+Shift+S` 開啟字幕視窗
- 🧪 **音頻設備測試** - 診斷虛擬音頻設備和檢查訊號強度
- ✕ **多種關閉方式** - ESC鍵、點擊外部、關閉按鈕

### 問題修復
- 🔧 修復語音識別返回 "undefined" 的問題
- 🔧 修復翻譯API錯誤處理
- 🔧 增加更好的錯誤回饋機制
- 🔧 修復獨立視窗捲動問題
- 🔧 修復設定面板顯示問題
- 🔧 修復錄音停止後自動重啟的問題
- 🔧 修復虛擬音頻設備 (VB-Audio Cable) 支援問題
- 🔧 修復設定面板無法關閉的問題
- 🔧 修復錄音按鈕無法停止錄音和重複觸發的問題

## 📦 安裝方式

1. 下載此專案
2. 開啟 Chrome 瀏覽器
3. 進入 `chrome://extensions/`
4. 開啟「開發者模式」
5. 點擊「載入未封裝項目」
6. 選擇此專案資料夾

## 🚀 使用方式

### 方式一：網頁字幕模式
1. 開啟任何網頁
2. 點擊插件圖標
3. 點擊「開始錄音」

### 方式二：獨立視窗模式 (推薦)
1. 點擊插件圖標
2. 點擊「🪟 獨立視窗」
3. 在獨立視窗中點擊「開始錄音」

## 🎯 翻譯服務選項

### 免費翻譯 (推薦)
- ✅ 無需API金鑰
- ✅ 立即可用
- ✅ 支援多種語言
- ⚡ 使用 MyMemory 翻譯API

### Microsoft Translator
- 🔑 需要API金鑰
- 🎯 高精度翻譯
- 💰 付費服務

### OpenAI Whisper + GPT
- 🔑 需要API金鑰
- 🧠 AI驅動語音識別和翻譯
- ✅ **支援虛擬音頻設備**
- 💰 付費服務

## ⌨️ 快捷鍵

- `Ctrl+Shift+S` - 開啟/聚焦字幕視窗
- `Ctrl+Shift+R` - 開始/停止錄音
- `Ctrl+Shift+C` - 清除字幕 (在字幕視窗中)
- `Ctrl+Shift+T` - 開啟/關閉設定面板 (在獨立視窗中)
- `Ctrl+Shift+L` - 切換語音識別語言
- `Ctrl+S` - 開啟統一設定界面 (在popup中)
- `ESC` - 關閉設定面板 (當設定面板開啟時)

## 🎯 使用說明 (v2.3.3 增強版網頁字幕)

### **🎤 增強版網頁字幕模式**
**適用場景：** Teams會議、YouTube、線上課程、Zoom會議等
**全新功能：** 完整的記錄和翻譯系統，媲美獨立視窗

#### **三面板專業界面**
1. **📺 即時字幕面板**
   - 實時顯示語音識別結果
   - 即時翻譯狀態提示
   - 講者識別和時間戳
   - 翻譯進度實時更新

2. **📚 會話記錄面板**
   - 完整保存所有對話記錄
   - 按時間順序顯示
   - 包含原文和所有翻譯結果
   - 支援匯出為文本文件

3. **🌐 翻譯結果面板**
   - 專門的翻譯查看界面
   - 多語言翻譯結果對比
   - 翻譯重新整理功能
   - 目標語言快速切換

#### **使用步驟**
1. **開啟網頁**：進入有聲音的網頁（Teams、YouTube等）
2. **點擊插件圖標** → 選擇「🎤 網頁字幕」
3. **允許麥克風權限**：確保網站可以使用麥克風
4. **專業界面開啟**：自動顯示三面板專業字幕界面
5. **切換面板**：點擊頂部按鈕切換不同面板檢視
6. **持續記錄**：講者持續講話時，所有面板同步更新

#### **界面操作**
- **拖拽移動**：點擊標題欄拖拽移動位置
- **最小化**：點擊「─」按鈕最小化界面
- **面板切換**：📺 即時 | 📚 記錄 | 🌐 翻譯
- **功能按鈕**：每個面板都有專門的操作按鈕
- **關閉界面**：點擊「×」按鈕關閉

### **🪟 獨立視窗模式**
**適用場景：** 實體會議、需要完整功能、多語言翻譯等
1. **點擊插件圖標** → 選擇「🪟 獨立字幕視窗」
2. **完整設定**：在獨立視窗中進行詳細配置
3. **開始錄音**：使用完整的語音識別和翻譯功能

**優勢：**
- ✅ 功能完整：Whisper引擎、音頻設備測試、說話者分離
- ✅ 適合實體會議和長時間使用
- ✅ 支援虛擬音頻設備（VB-Audio Cable）
- ✅ 歷史記錄和匯出功能

### **💡 模式選擇建議**
- **線上會議/YouTube** → 使用「🎤 網頁字幕」（現在功能完整！）
- **實體會議/虛擬音頻設備** → 使用「🪟 獨立視窗」
- **需要Whisper引擎** → 使用「🪟 獨立視窗」
- **快速臨時使用** → 使用「🎤 網頁字幕」

## 🔧 設定說明

### 基本設定
1. 選擇翻譯服務 (建議使用免費翻譯)
2. 選擇目標語言
3. 儲存設定

### API金鑰設定 (可選)
- Microsoft Translator: 在 Azure 取得金鑰
- OpenAI: 在 OpenAI 官網取得金鑰

## 🐛 常見問題

### 語音識別不工作
- 確認麥克風權限已開啟
- 檢查瀏覽器是否支援語音識別
- 嘗試重新載入頁面

### 翻譯失敗
- 免費翻譯：檢查網路連接
- 付費服務：檢查API金鑰是否正確

### 字幕視窗無法開啟
- 確認插件已正確安裝
- 嘗試重新載入插件

### 設定面板看不到或無法關閉
**開啟設定面板：**
- 使用快捷鍵 `Ctrl+Shift+T` 開啟設定面板
- 確認瀏覽器視窗足夠大以顯示側邊面板
- 嘗試重新載入插件

**關閉設定面板：**
- 🔑 **ESC 鍵**：按下 ESC 鍵即可關閉
- ⌨️ **快捷鍵**：再次按 `Ctrl+Shift+T` 切換關閉
- 🖱️ **點擊外部**：點擊設定面板外的任何區域
- ❌ **關閉按鈕**：點擊設定面板右上角的 ✕ 按鈕

### 錄音停止後自動重新開始
- 這個問題已在 v2.2.1 修復
- 如果仍有問題，請重新載入插件

### 錄音按鈕無法停止錄音或重複觸發
- **問題原因**：按鈕事件重複綁定或快速重複點擊
- **已修復**：v2.2.5 新增防護機制
- **解決方案**：
  - 重新載入插件
  - 避免快速重複點擊錄音按鈕
  - 等待按鈕狀態更新後再次操作

### 設定面板無法打開（v2.2.5 後）
- **問題原因**：錄音按鈕優化時影響了其他按鈕的事件綁定
- **已修復**：v2.2.6 改善事件監聽器綁定邏輯
- **解決方案**：
  - 重新載入插件即可恢復正常
  - 檢查瀏覽器控制台是否有錯誤信息

### 雙模式並行 (v2.3.2)
- **模式選擇**：根據使用場景選擇「網頁字幕」或「獨立視窗」
- **網頁字幕問題**：
  - 確保網站已允許麥克風權限
  - 檢查網頁是否有聲音輸出
  - 不支援chrome://和extension頁面
- **獨立視窗問題**：
  - 音頻設備測試功能可診斷設備問題
  - 虛擬音頻設備需要使用Whisper引擎
  - 確保OpenAI API Key正確配置
- **設定同步**：兩種模式共享設定，修改後立即同步
- **使用建議**：
  - Teams/YouTube會議 → 使用「網頁字幕」
  - 實體會議/需要完整功能 → 使用「獨立視窗」

### 統一設定界面 (v2.3.1)
- **設定統一**：popup和獨立視窗現在使用相同的設定界面
- **操作方式**：popup點擊「⚙️ 設定」自動開啟獨立視窗的設定面板
- **功能完整**：包含語音識別引擎、音頻設備、翻譯服務等所有設定
- **即時同步**：設定修改後兩邊立即同步，確保一致性
- **使用建議**：
  - 所有設定調整都在統一的設定界面中進行
  - 設定完成後可直接在獨立視窗中開始使用
  - 確保音頻設備測試通過後再開始錄音

### 架構整合升級 (v2.3.0)
- **重要變更**：原始字幕功能已整合到獨立視窗
- **自動升級**：舊版設定會自動遷移到新版格式
- **使用建議**：
  - 建議使用「🪟 獨立字幕視窗」獲得完整功能
  - popup界面主要作為功能引導和快速啟動
  - 所有語音識別操作請在獨立視窗中進行

### 虛擬音頻設備 (VB-Audio Cable) 問題診斷

**問題原因：**
- 瀏覽器語音識別 API 不支援指定音頻設備
- 虛擬音頻設備需要特殊處理

**解決步驟：**
1. **切換引擎**：設定 → 語音識別引擎 → 選擇 "OpenAI Whisper"
2. **填入API Key**：設定 → OpenAI API Key
3. **選擇設備**：設定 → 音頻輸入設備 → 選擇 VB-Audio Cable
4. **測試設備**：點擊音頻設備旁的 🧪 測試按鈕

**診斷功能：**
- 🧪 **測試按鈕**：檢查設備是否可存取
- 📊 **訊號檢測**：自動檢測是否有音頻輸入
- ⚠️ **狀態提示**：即時顯示設備狀態和問題

**常見問題：**
- 如果測試成功但沒有訊號：檢查播放軟體是否輸出到 VB-Audio Cable
- 如果設備無法存取：檢查其他程式是否佔用設備
- 如果權限被拒絕：重新整理頁面並允許麥克風權限

### 增強版網頁字幕問題 (v2.3.3)
- **面板無法切換**：
  - 檢查是否點擊了正確的面板按鈕（📺 即時 | 📚 記錄 | 🌐 翻譯）
  - 重新載入網頁並重新啟動網頁字幕
  - 確認瀏覽器支援現代JavaScript功能
- **記錄未保存**：
  - 確保已開始錄音並有語音輸入
  - 檢查麥克風權限是否正確授予
  - 查看瀏覽器控制台是否有錯誤訊息
- **翻譯面板空白**：
  - 確認已有語音識別結果
  - 檢查網路連線是否正常
  - 驗證翻譯API設定是否正確
- **界面顯示異常**：
  - 確認螢幕解析度支援界面顯示
  - 檢查是否與其他插件產生衝突
  - 嘗試重新載入網頁
- **匯出功能無效**：
  - 確保瀏覽器允許文件下載
  - 檢查是否有會話記錄可匯出
  - 確認瀏覽器的下載設定

### Teams會議專用問題解決 (v2.3.3)
- **Teams環境自動檢測**：插件會自動識別Teams環境並啟用增強模式
- **音頻權限問題**：
  - 點擊網址列左側的鎖頭/麥克風圖標
  - 選擇「允許」麥克風權限
  - 重新載入頁面並重新啟動網頁字幕
- **音頻衝突解決**：
  - 如果Teams正在使用麥克風，先退出Teams通話
  - 重新載入頁面
  - 啟動網頁字幕
  - 再重新加入Teams通話
- **Teams特殊限制**：
  - Teams頁面有特殊的音頻安全限制
  - 建議在加入會議前先啟動網頁字幕
  - 如果仍有問題，可使用「獨立視窗模式」作為替代
- **診斷信息**：
  - 控制台會顯示詳細的音頻診斷信息
  - 包含可用音頻設備和環境狀態檢查

## 📋 支援語言

- 繁體中文 (zh-tw)
- 簡體中文 (zh-cn)
- 英文 (en)
- 日文 (ja)
- 韓文 (ko)
- 法文 (fr)
- 德文 (de)
- 西班牙文 (es)
- 意大利文 (it)
- 葡萄牙文 (pt)
- 俄文 (ru)
- 阿拉伯文 (ar)
- 印地文 (hi)
- 泰文 (th)
- 越南文 (vi)
- 印尼文 (id)

## 📄 版本歷史

### v2.3.3 (最新) - 增強版網頁字幕
- 🎯 **多面板界面**：即時字幕、會話記錄、翻譯結果三個專門面板
- 📝 **完整記錄系統**：持續記錄所有對話內容，如同獨立視窗
- 🌐 **分離式翻譯**：專門的翻譯面板，方便查看和管理翻譯結果
- 📚 **會話歷史**：自動保存所有對話記錄，支援匯出TXT文件
- 🎮 **專業界面**：可拖拽、可最小化的專業級字幕界面
- ⚡ **即時更新**：講者持續講話時，各面板同步更新內容
- 🔄 **面板切換**：即時、記錄、翻譯三個面板快速切換
- 📤 **匯出功能**：會話記錄可匯出為格式化文本文件

### v2.3.2 - 恢復網頁聲音監聽
- 🎤 **網頁字幕模式**：恢復監聽當前網頁聲音功能（Teams會議、YouTube等）
- 🪟 **獨立視窗模式**：適合實體會議和完整功能操作
- 🔄 **雙軌並行**：兩種模式各司其職，滿足不同使用場景
- ⚙️ **統一設定**：兩種模式共享相同的設定系統，確保一致性
- 🎯 **清晰功能**：popup界面明確區分兩種使用模式

### v2.3.1 - 統一設定界面
- ⚙️ **設定統一**：popup和獨立視窗使用相同的設定界面
- 🔗 **完整設定**：popup的"設定"按鈕直接開啟獨立視窗的完整設定面板
- 🎯 **簡化界面**：popup界面簡化，專注於快速啟動功能
- 🔄 **實時同步**：設定修改後兩邊即時同步，確保一致性
- 💡 **用戶引導**：清晰提示用戶使用統一的設定界面

### v2.3.0 - 架構整合重大更新
- 🔄 **功能整合**：原始字幕功能與獨立視窗功能完全整合
- ⚙️ **統一設定**：所有功能共享相同的設定系統，自動遷移舊設定
- 🪟 **統一界面**：popup界面引導用戶使用功能完整的獨立視窗
- 🔧 **架構優化**：移除重複的語音識別實現，避免功能衝突
- 📱 **用戶體驗**：簡化操作流程，提供清晰的功能說明
- 🛠️ **向下兼容**：自動檢測並遷移舊版設定，確保無縫升級

### v2.2.6
- 🔧 修復設定面板因錄音按鈕優化而無法打開的問題
- 🛠️ 改善事件監聽器綁定邏輯，確保所有按鈕正常工作
- 🔍 新增按鈕元素檢查機制，提供更好的調試信息
- ⚡ 優化事件處理性能，移除會影響其他元素的操作

### v2.2.5
- 🔧 修復錄音按鈕無法停止錄音和重複觸發的問題
- 🛡️ 新增錄音切換防護機制，防止重複調用
- ⏱️ 新增按鈕防抖機制，避免快速重複點擊
- 🔄 改善按鈕狀態即時更新邏輯
- 🛠️ 優化事件監聽器，移除重複綁定問題

### v2.2.4
- 🔧 徹底修復設定面板無法關閉的問題
- ✨ 新增設定面板右上角關閉按鈕 (✕)
- ⚙️ 重構設定面板關閉邏輯，支援多種關閉方式
- 🧪 新增音頻設備測試功能，幫助診斷虛擬音頻設備問題
- 📊 新增音頻訊號強度檢測，自動診斷設備狀態
- 🎙️ 改善Whisper引擎的音頻設備支援和狀態顯示
- 🛠️ 移除重複的事件處理函數，提升穩定性

### v2.2.3
- 🔧 修復設定面板無法關閉的問題
- ✨ 新增 ESC 鍵關閉設定面板功能
- 🖱️ 改善點擊外部區域關閉面板的邏輯  
- ❌ 新增設定面板關閉按鈕
- 🛠️ 移除重複的事件處理函數，提升穩定性

### v2.2.2
- 🔧 修復虛擬音頻設備支援問題
- ⚠️ 新增虛擬音頻設備使用提示和引導
- 🎙️ 改善音頻設備切換邏輯
- 📝 新增詳細的設備兼容性說明

### v2.2.1
- 修復獨立視窗捲動問題
- 修復設定面板顯示問題  
- 修復錄音停止後自動重啟的問題
- 新增更多鍵盤快捷鍵支援
- 改善用戶界面響應性

### v2.2.0
- 新增免費翻譯功能
- 新增獨立字幕視窗
- 修復語音識別問題
- 改善錯誤處理

### v2.1.2
- 基本語音識別和翻譯功能
- 支援多種翻譯服務

## 📞 支援

如有問題，請建立 Issue 或聯繫開發者。

## 📜 授權

MIT License 
